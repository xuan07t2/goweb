<!DOCTYPE html>
<html lang="en">
  <head>

    <!-- Declared Vars To Go Here -->

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Metadata -->
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="icon" href="mysource_files/favicon.ico">

    <!-- Page Name and Site Name -->
    <title>Page Name - Squiz Matrix HTML Example</title>

    <!-- CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <link href="mysource_files/style.css" rel="stylesheet">
    <!-- CDP Web Insight script -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.22.3/sdk.js"></script>
    
    <script>
        // Hàm khởi tạo LIFF và lấy LineUID
        function initializeLiff() {
            // Thay 'YOUR_LIFF_ID' bằng LIFF ID của bạn
            liff.init({ liffId: '1655694749-DlBp3RB8' })
                .then(() => {
                    if (liff.isLoggedIn()) {
                        // Lấy thông tin người dùng sau khi đăng nhập
                        liff.getProfile()
                            .then(profile => {
                                // Lưu LineUID vào biến
                                const lineUID = profile.userId;
                                document.getElementById('uid').textContent = `Your LineUID: ${lineUID}`;

                                for (let i = 0; i < maxAttempts; i++) {
                                let inputElement = document.getElementById("xuantest");
                                
                                if (inputElement) {
                                  // Nếu phần tử tồn tại, đặt giá trị mới và thoát vòng lặp
                                  inputElement.value = lineUID;
                                  console.log("Giá trị đã được đặt!");
                                  break;
                                } else {
                                  // Nếu phần tử không tồn tại, in ra thông báo
                                  console.log("Phần tử chưa tồn tại. Tiếp tục kiểm tra...");
                                }

                                // Tăng số lần thử và thoát vòng lặp nếu đạt tới giới hạn
                                attempt++;
                                if (attempt >= maxAttempts) {
                                  console.log("Đã đạt tới giới hạn kiểm tra.");
                                  break;
                                }
                              }
                                
                            })
                            .catch(err => {
                                console.error('Error getting profile: ', err);
                            });
                    } else {
                        // Đăng nhập nếu chưa đăng nhập
                        liff.login();
                    }
                })
                .catch(err => {
                    console.error('LIFF Initialization failed ', err);
                });
        }

        // Chạy hàm khởi tạo khi trang tải
        window.onload = initializeLiff;
    </script>

    <script type = "text/javascript" >
      var _portalId = "564890345"; // Portal DTVN CDP 
      var _propId = "564991998"; 
      var _ATM_TRACKING_ASSOCIATE_UTM = 1 ; // https://hr.dac-datatech.vn/requestoff/login 
    (function() {
      var w = window;
      if (w.web_event) return;
      var a = window.web_event = function() {
          a.queue.push(arguments);
      }
      a.propId = _propId;
      a.track = a;
      a.queue = [];
      var e = document.createElement("script");
      e.type = "text/javascript", e.async = !0, e.src = "//st-a.cdp.asia/insight.js";
      var t = document.getElementsByTagName("script")[0];
      t.parentNode.insertBefore(e, t)
    })(); </script>
    <!-- End of CDP Web Insight script -->
     

  </head>

  <body class="bodydiv">
    <p id="uid">Loading...1</p>

    <div class="container">      

    </div> <!-- /container -->

  </body>
</html>